# Capital Gains Tax Calculator (Nubank Challenge)

This project implements a capital gains tax calculator according to the rules defined in the Nubank technical challenge.

The program reads a list of stock operations from standard input (`stdin`) and outputs the tax to be paid for each operation to standard output (`stdout`).

---

## Problem Summary

Each operation is either:

- `buy`: purchase of shares
- `sell`: sale of shares

For every operation, the program must output the tax owed, following the rules below.

---

## Business Rules Implemented

1. **Weighted Average Price**
   - The average stock price is recalculated on every buy operation.
2. **Tax-Free Threshold**
   - If the total value of a sell operation is **â‰¤ R$ 20,000**, no tax is applied.
3. **Capital Gains Tax**
   - Tax rate is **20%** over the profit.
4. **Loss Compensation**
   - Losses are accumulated and used to offset future profits.
   - Taxes are applied only after losses are fully compensated.
5. **Precision**
   - Monetary values are rounded to **two decimal places**.
6. **Output Format**
   - Each operation receives a JSON object and outputs the tax result in console:
     ```json
     { "tax": <value> }
     ```

---

## How to Run

### First run the code with "python 26.-Nu Bank Exercise.py" and then manually paste each case in console and look at the result.
#### CASE 1:
```bash
[{"operation":"buy","unit-cost":10.00,"quantity":100},{"operation":"sell","unit-cost":15.00,"quantity":50},{"operation":"sell","unit-cost":15.00,"quantity":50}]
```
**Result:**
[{"tax":0.0},{"tax":0.0},{"tax":0.0}]

#### CASE 2:
```bash
[{"operation":"buy","unit-cost":10.00,"quantity":10000},{"operation":"sell","unit-cost":20.00,"quantity":5000},{"operation":"sell","unit-cost":5.00,"quantity":5000}]
```
**Result:**
[{"tax":0.0},{"tax":10000.0},{"tax":0.0}]

#### CASE 3:
```bash
[{"operation":"buy","unit-cost":10.00,"quantity":10000},{"operation":"sell","unit-cost":5.00,"quantity":5000},{"operation":"sell","unit-cost":20.00,"quantity":3000}]
```
**Result:**
[{"tax":0.0},{"tax":0.0},{"tax":1000.0}]

#### CASE 4:
```bash
[{"operation":"buy","unit-cost":10.00,"quantity":10000},{"operation":"buy","unit-cost":25.00,"quantity":5000},{"operation":"sell","unit-cost":15.00,"quantity":10000}]
```
**Result:**
[{"tax":0.0},{"tax":0.0},{"tax":0.0}]

#### CASE 5:
```bash
[{"operation":"buy","unit-cost":10.00,"quantity":10000},{"operation":"buy","unit-cost":25.00,"quantity":5000},{"operation":"sell","unit-cost":15.00,"quantity":10000},{"operation":"sell","unit-cost":25.00,"quantity":5000}]
```
**Result:**
[{"tax":0.0},{"tax":0.0},{"tax":0.0},{"tax":10000.0}]

#### CASE 6:
```bash
[{"operation":"buy","unit-cost":10.00,"quantity":10000},{"operation":"sell","unit-cost":2.00,"quantity":5000},{"operation":"sell","unit-cost":20.00,"quantity":2000},{"operation":"sell","unit-cost":20.00,"quantity":2000},{"operation":"sell","unit-cost":25.00,"quantity":1000}]
```
**Result:**
[{"tax":0.0},{"tax":0.0},{"tax":0.0},{"tax":0.0},{"tax":3000.0}]

#### CASE 7:
```bash
[{"operation":"buy","unit-cost":10.00,"quantity":10000},{"operation":"sell","unit-cost":2.00,"quantity":5000},{"operation":"sell","unit-cost":20.00,"quantity":2000},{"operation":"sell","unit-cost":20.00,"quantity":2000},{"operation":"sell","unit-cost":25.00,"quantity":1000},{"operation":"buy","unit-cost":20.00,"quantity":10000},{"operation":"sell","unit-cost":15.00,"quantity":5000},{"operation":"sell","unit-cost":30.00,"quantity":4350},{"operation":"sell","unit-cost":30.00,"quantity":650}]
```
**Result:**
[{"tax":0.0},{"tax":0.0},{"tax":0.0},{"tax":0.0},{"tax":3000.0},{"tax":0.0},{"tax":0.0},{"tax":3700.0},{"tax":0.0}]

#### CASE 8:
```bash
[{"operation":"buy","unit-cost":10.00,"quantity":10000},{"operation":"sell","unit-cost":50.00,"quantity":10000},{"operation":"buy","unit-cost":20.00,"quantity":10000},{"operation":"sell","unit-cost":50.00,"quantity":10000}]
```
**Result:**
[{"tax":0.0},{"tax":80000.0},{"tax":0.0},{"tax":60000.0}]

#### CASE 9:
```bash
[{"operation":"buy","unit-cost":5000.00,"quantity":10},{"operation":"sell","unit-cost":4000.00,"quantity":5},{"operation":"buy","unit-cost":15000.00,"quantity":5},{"operation":"buy","unit-cost":4000.00,"quantity":2},{"operation":"buy","unit-cost":23000.00,"quantity":2},{"operation":"sell","unit-cost":20000.00,"quantity":1},{"operation":"sell","unit-cost":12000.00,"quantity":10},{"operation":"sell","unit-cost":15000.00,"quantity":3}]
```
**Result:**
[{"tax":0.0},{"tax":0.0},{"tax":0.0},{"tax":0.0},{"tax":0.0},{"tax":0.0},{"tax":1000.0},{"tax":2400.0}]

![Nu Bank](0.-Archivos_Ejercicios_Python/img/Nu_Bank.png)